@using GridMvc.Html
@using System.Configuration;
@model List<NYCMappingWebApp.Models.MyReport>

@{
    Layout = "~/Views/Shared/_EmptyLayout.cshtml";
    string infoMessage = TempData["InfoMessage"] as string;
    string errorMessage = TempData["ErrorMessage"] as string;
    string targetFolder = Server.MapPath("~/Reports");
}
@if (infoMessage != null)
{
    <div class="form-group">
        <div class="alert alert-success fade in">
            @infoMessage
        </div>
    </div>
}
@if (errorMessage != null)
{
    <div class="form-group">
        <div class="alert alert-danger fade in">
            @errorMessage
        </div>
    </div>
}

@if (Model.Count > 0)
{
    <h2>Reports for @User.Identity.Name</h2>

    <div class="form-group">
        @Html.Grid(Model).Columns(columns =>
       {
           columns.Add(model => model.ReportName, "ReportName")
               .Titled("ReportName")
               .SetWidth(30);
           columns.Add()
               .Encoded(false)
               .Sanitized(false)
               .SetWidth(30)
               .RenderValueAs(model => openReport(model));
       }).WithPaging(20, 6, "grid1-page").Sortable().Filterable().WithMultipleFilters()
    </div>
}
else
{
    <h2>@User.Identity.Name you still don't have any reports saved</h2>
}
@helper openReport(NYCMappingWebApp.Models.MyReport model)
{
    <a href="@Path.Combine(Url.Content("~/Reports"), model.FileName)">Open</a>
}